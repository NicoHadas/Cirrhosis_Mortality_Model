# 6-Month Cirrhosis Mortality Prediction Model

## Overview
This repository contains the code and methodology for a machine learning model designed to predict 6-month mortality risk in patients with cirrhosis. The model utilizes synthetic medical data generated via MDClone, aiming to identify key predictive factors and provide a framework for prognostic assessment in this patient population.

---

## Data Source
-   **MDClone Synthetic Data**: The dataset used for this project is synthetic, generated using MDClone. It simulates real-world patient data relevant to cirrhosis, including demographics, laboratory values, clinical scores, and complications.
    -   *Note: As this data is synthetic, it does not contain real patient information. However, access to and use of MDClone-generated data may be subject to institutional or organizational policies.*

---

## Repository Structure

-   **/Python**
    -   `Cirrhosis_Modeling.ipynb`: Jupyter notebook containing all Python code for data loading, preprocessing, feature engineering, model training (including Logistic Regression, Random Forest, and XGBoost), hyperparameter tuning, evaluation, and feature importance analysis (SHAP).

---

## Methods Summary

A machine learning pipeline was developed to predict 6-month mortality in a synthetic cohort of cirrhosis patients.

1.  **Data Loading and Initial Exploration**:
    * Synthetic data representing cirrhosis patients, generated by MDClone, was loaded.
    * Initial exploratory data analysis (EDA) was performed to understand feature distributions and identify missing values.
2.  **Cohort Definition**:
    * The study focused on adult patients with a diagnosis of cirrhosis.
    * The outcome variable was 6-month mortality.
3.  **Feature Engineering and Selection**:
    * Features included:
        * **Demographics**: Age, Gender.
        * **Laboratory Values**: Platelets, Total Bilirubin, Albumin, Creatinine, INR (International Normalized Ratio), Sodium.
        * **Clinical Scores**: MELD score (Model for End-Stage Liver Disease).
        * **Complications/Conditions**: Ascites (presence/grade), Hepatic Encephalopathy (presence/grade), Varices.
    * Categorical features were one-hot encoded.
4.  **Data Preprocessing**:
    * Missing data was handled using imputation techniques (e.g., median imputation for numerical features).
    * The dataset was split into training (80%) and testing (20%) sets.
5.  **Modeling**:
    * Several classification models were explored, including Logistic Regression, Random Forest, and XGBoost.
    * XGBoost was selected as the primary model for further optimization.
    * Hyperparameter tuning for the XGBoost model was performed using GridSearchCV with 3-fold cross-validation, optimizing for parameters like `n_estimators`, `max_depth`, `learning_rate`, `gamma`, `subsample`, and `colsample_bytree`.
6.  **Model Evaluation**:
    * The performance of the tuned XGBoost model was assessed on the test set using:
        * Accuracy
        * Area Under the Precision Recall Curve (AUPCR).
    * Feature importance was analyzed using SHAP (SHapley Additive exPlanations) values to understand the contribution of each feature to the model's predictions.

---

## Results Summary

The hypertuned XGBoost model demonstrated good predictive performance for 6-month cirrhosis mortality on the synthetic dataset.

* **Key Performance Metrics (Test Set - XGBoost)**:
    * *AUCPR score of 0.74, Accuracy of 0.77*
* **Significant Predictors (based on SHAP analysis)**:
    * *Higher Fib-4 scores, older Age, and higher Blood Urea Nitrogen were strong predictors of mortality.*

The model identified clinically relevant features and showed promising results in predicting 6-month mortality, underscoring the potential of machine learning in risk stratification for cirrhosis patients, even when developed on synthetic data.

---
